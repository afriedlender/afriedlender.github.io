---
layout: post
title: Creating Python Visualizations using Pandas and Matplotlib
---

# Assignment - Blog Post 1

In this post, we'll be working with data collected from the National Oceanic and Atmospheric Administration (NOAA). The NOAA is an American scientific agency with the United States Department of Commerce that focuses on the conditions of the oceans, major waterways, and the atmosphere. You can read more about this orgnization <a href="https://www.noaa.gov/"> here</a>. 

We have three seperate datasets to work with. The first, **temps.csv**, contains temperature month over month measurments collected from various global stations from the 1930s till 2021. Next, we have two github datasets, which we'll name **stations** and **countries** that we'll join with **temps.csv** to get the data to be displaid by country and region. 

In this post we'll create some visualizations that'll help us address the following three key questions: 

**1. How does the average yearly change in temperature vary within a given country?**
**2. In a given timeframe, how does change in average temperature vary globally? **
**3. How has global temperature chaged year over year compared to the mid 1900s?**



### Importing Data

First, like in any python task, we must import the necessary modules. We'll import the most general ones here and  others later as we need them.

For more detail on pandas, numpy, and matplotlib see my post on  <a href="https://afriedlender.github.io/blog-post-0/"> Creating Python Visualizations using Pandas and Matplotlib</a>.

Here we'll also be importing sqlite3 and plotly.

Sqlite3 is a package we can use to work with databases. It is often best to use databased when working with larger datasets as loading them completely with pandas may take up a lot of memory and computing power.

Plotly, in particular plotly.express, can be used to create more interactive and exciting plots. We'll use plotly here to create map plots.



```python
import pandas as pd
import numpy as np
from matplotlib import pyplot as plt
import sqlite3
from plotly import express as px
```

### Creating a Database

As we'll be working with a large amount of data, we should store the data in a databse as to avoid overloading our hardware system. 

First, we must open a connection to a database. When we connect to a pre-existing databse we open it. If we connect to a non-existant database, we will create one.


```python
conn = sqlite3.connect("temps.db") # create a database in current directory called temps.db
```

The first dataset initally resembles a pivot table; it has seperate columns for each month's temperature measurment. Before implementing the data into our databse we will need to reshape it. 


```python
interval = "2011-2020"
url = f"https://raw.githubusercontent.com/PhilChodrow/PIC16B/master/datasets/noaa-ghcn/decades/{interval}.csv"
df = pd.read_csv(url)

df.head(5)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Year</th>
      <th>VALUE1</th>
      <th>VALUE2</th>
      <th>VALUE3</th>
      <th>VALUE4</th>
      <th>VALUE5</th>
      <th>VALUE6</th>
      <th>VALUE7</th>
      <th>VALUE8</th>
      <th>VALUE9</th>
      <th>VALUE10</th>
      <th>VALUE11</th>
      <th>VALUE12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ACW00011604</td>
      <td>2011</td>
      <td>-83.0</td>
      <td>-132.0</td>
      <td>278.0</td>
      <td>1040.0</td>
      <td>1213.0</td>
      <td>1663.0</td>
      <td>1875.0</td>
      <td>1723.0</td>
      <td>1466.0</td>
      <td>987.0</td>
      <td>721.0</td>
      <td>428.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ACW00011604</td>
      <td>2012</td>
      <td>121.0</td>
      <td>-98.0</td>
      <td>592.0</td>
      <td>646.0</td>
      <td>1365.0</td>
      <td>1426.0</td>
      <td>1771.0</td>
      <td>1748.0</td>
      <td>1362.0</td>
      <td>826.0</td>
      <td>620.0</td>
      <td>-234.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ACW00011604</td>
      <td>2013</td>
      <td>-104.0</td>
      <td>-93.0</td>
      <td>-48.0</td>
      <td>595.0</td>
      <td>NaN</td>
      <td>1612.0</td>
      <td>1855.0</td>
      <td>1802.0</td>
      <td>1359.0</td>
      <td>1042.0</td>
      <td>601.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AE000041196</td>
      <td>2011</td>
      <td>1950.0</td>
      <td>2060.0</td>
      <td>2280.0</td>
      <td>2760.0</td>
      <td>3240.0</td>
      <td>3447.0</td>
      <td>3580.0</td>
      <td>3650.0</td>
      <td>3316.0</td>
      <td>2940.0</td>
      <td>2390.0</td>
      <td>1905.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AE000041196</td>
      <td>2012</td>
      <td>1837.0</td>
      <td>1987.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
def prepare_df(df):
    """
    This function will take in each subset of the `temps.csv` dataframe.
    It will reshape the data in order to have the following columns:
    ID     Year    Monnth    Temp
        
    """
    df = df.set_index(keys=["ID", "Year"])
    df = df.stack()
    df = df.reset_index()
    df = df.rename(columns = {"level_2"  : "Month" , 0 : "Temp"})
    df["Month"] = df["Month"].str[5:].astype(int)
    df["Temp"]  = df["Temp"] / 100
    return(df)
```

## Say stuff about iterating through temps.csv

Add link to lecture notes


```python
df_iter = pd.read_csv("temps.csv", chunksize = 100000)
for df in df_iter:
    df = prepare_df(df)
    df.to_sql("temperatures", conn, if_exists = "append", index = False)
```


```python
stations_url = "https://raw.githubusercontent.com/PhilChodrow/PIC16B/master/datasets/noaa-ghcn/station-metadata.csv"
stations = pd.read_csv(stations_url)
stations.to_sql("stations", conn, if_exists = "replace", index = False)

countries_url = "https://raw.githubusercontent.com/mysociety/gaze/master/data/fips-10-4-to-iso-country-codes.csv"
countries = pd.read_csv(countries_url)
countries.to_sql("countries", conn, if_exists = "replace", index = False)
```

    /Users/Adriel/Documents/anaconda3/envs/PIC16B/lib/python3.7/site-packages/pandas/core/generic.py:2789: UserWarning: The spaces in these column names will not be changed. In pandas versions < 0.14, spaces were converted to underscores.
      method=method,



```python
conn.close()
```

# How does the average yearly change in temperature vary within a given country?



Let's plot estimates of yearly change collected by the different temperature measuring stations of a given coutry. In this example, we'll look at tempuratues of India for all the years of data we have available.
First, let's create a function to query the data that we'll use to plot our map.


```python
def query_climate_database(country,year_begin, year_end, month):
    
    """
    Accepts four arguments:
    
    country               : a string giving the name of a country for which data should be returned.
    year_begin / year_end : two integers giving the earliest and latest years for which should be returned.
    month                 : an integer giving the month of the year for which should be returned.
    
    The return value of query_climate_database() is a Pandas dataframe of temperature readings 
    for the specified country, in the specified date range, in the specified month of the year.
    """
    
    conn = sqlite3.connect("temps.db")
    
    cmd = \
    """
    SELECT 
    S.NAME,
    S.LATITUDE,
    S.LONGITUDE,
    C.Name as Country,
    T.Year,
    T.Month,
    T.Temp
    FROM temperatures T 
    LEFT JOIN stations S ON T.id = S.id
    LEFT JOIN countries C ON substr(T.id, 1, 2) = C."FIPS 10-4"
    WHERE T.Year >=""" + str(year_begin) + \
    """
    AND T.Year <=""" + str(year_end) + \
    """
    AND T.Month =""" + str(month)


    df = pd.read_sql_query(cmd, conn)
    conn.close()
    return df[df["Country"] == country]

query_climate_database(country = "India", 
                       year_begin = 1980, 
                       year_end = 2020,
                       month = 1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAME</th>
      <th>LATITUDE</th>
      <th>LONGITUDE</th>
      <th>Country</th>
      <th>Year</th>
      <th>Month</th>
      <th>Temp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>165212</th>
      <td>PBO_ANANTAPUR</td>
      <td>14.583</td>
      <td>77.633</td>
      <td>India</td>
      <td>1980</td>
      <td>1</td>
      <td>23.48</td>
    </tr>
    <tr>
      <th>165213</th>
      <td>PBO_ANANTAPUR</td>
      <td>14.583</td>
      <td>77.633</td>
      <td>India</td>
      <td>1981</td>
      <td>1</td>
      <td>24.57</td>
    </tr>
    <tr>
      <th>165214</th>
      <td>PBO_ANANTAPUR</td>
      <td>14.583</td>
      <td>77.633</td>
      <td>India</td>
      <td>1982</td>
      <td>1</td>
      <td>24.19</td>
    </tr>
    <tr>
      <th>165215</th>
      <td>PBO_ANANTAPUR</td>
      <td>14.583</td>
      <td>77.633</td>
      <td>India</td>
      <td>1983</td>
      <td>1</td>
      <td>23.51</td>
    </tr>
    <tr>
      <th>165216</th>
      <td>PBO_ANANTAPUR</td>
      <td>14.583</td>
      <td>77.633</td>
      <td>India</td>
      <td>1984</td>
      <td>1</td>
      <td>24.81</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>168359</th>
      <td>DARJEELING</td>
      <td>27.050</td>
      <td>88.270</td>
      <td>India</td>
      <td>1983</td>
      <td>1</td>
      <td>5.10</td>
    </tr>
    <tr>
      <th>168360</th>
      <td>DARJEELING</td>
      <td>27.050</td>
      <td>88.270</td>
      <td>India</td>
      <td>1986</td>
      <td>1</td>
      <td>6.90</td>
    </tr>
    <tr>
      <th>168361</th>
      <td>DARJEELING</td>
      <td>27.050</td>
      <td>88.270</td>
      <td>India</td>
      <td>1994</td>
      <td>1</td>
      <td>8.10</td>
    </tr>
    <tr>
      <th>168362</th>
      <td>DARJEELING</td>
      <td>27.050</td>
      <td>88.270</td>
      <td>India</td>
      <td>1995</td>
      <td>1</td>
      <td>5.60</td>
    </tr>
    <tr>
      <th>168363</th>
      <td>DARJEELING</td>
      <td>27.050</td>
      <td>88.270</td>
      <td>India</td>
      <td>1997</td>
      <td>1</td>
      <td>5.70</td>
    </tr>
  </tbody>
</table>
<p>3152 rows × 7 columns</p>
</div>



#### Geographic Scatter Function


```python
from plotly import express as px
from sklearn.linear_model import LinearRegression

def coef(df):
    x = df[["Year"]] # 2 brackets because X should be a df
    y = df["Temp"]   # 1 bracket because y should be a series
    LR = LinearRegression()
    LR.fit(x, y)
    return LR.coef_[0]

def temperature_coefficient_plot(country,year_begin, year_end, month, min_obs, **kwargs):
    
    df = query_climate_database(country,year_begin, year_end, month)
    
    df = df[df.groupby("NAME")["NAME"].transform("size") >= min_obs]
    
    coefs = df.groupby(["NAME", "LATITUDE", "LONGITUDE", "Country"]).apply(coef)
    coefs = coefs.reset_index()
    coefs[0] = coefs[0].round(decimals = 4)
    coefs = coefs.rename(columns = {0 : "Estimated Yearly Change (°C)"})
   
    
    month_dict = {
        1  : "January",
        2  : "February",
        3  : "March",
        4  : "April",
        5  : "May",
        6  : "June",
        7  : "July",
        8  : "August",
        9  : "September",
        10 : "October",
        11 : "November",
        12 : "December"
    }
    
    fig = px.scatter_mapbox(coefs, 
                            lat = "LATITUDE",
                            lon = "LONGITUDE",
                            hover_name = "NAME",
                            title =
                            f"Estimates of yearly change in termperature in {month_dict[month]} " +
                            f"for stations in {country}, years {year_begin} - {year_end}",
                            color = "Estimated Yearly Change (°C)",
                            **kwargs)
    
    return fig


```


```python
# you have imported necessary packages
color_map = px.colors.diverging.RdGy_r # choose a colormap

fig = temperature_coefficient_plot("India", 1980, 2020, 1, 
                                   min_obs = 10,
                                   zoom = 2,
                                   mapbox_style="carto-positron",
                                   color_continuous_scale=color_map)

fig.show()

```


### In a given timeframe, how does change in average temperature vary among countries? 



```python
from urllib.request import urlopen
import json

countries_gj_url = "https://raw.githubusercontent.com/PhilChodrow/PIC16B/master/datasets/countries.geojson"

with urlopen(countries_gj_url) as response:
    countries_gj = json.load(response)
```


```python
def temperature_variation_map(year_start, year_end, **kwargs):
    
    conn = sqlite3.connect("temps.db")
    
    cmd0 = \
    f"""
    SELECT * FROM temperatures
    WHERE {year_start} <= Year AND Year <= {year_end}
    """
    cmd1 = \
    f"""
    SELECT * FROM countries
    """
    temps = pd.read_sql_query(cmd0, conn)
    countries = pd.read_sql_query(cmd1,conn)
    conn.close()
    
    temps = temps[["ID", "Year", "Temp"]].groupby(["ID", "Year"]).mean("temp").reset_index()
    temps = pd.pivot(temps, index = "ID", columns = "Year", values = "Temp").reset_index()
    temps["FIPS 10-4"] = temps["ID"].str[0:2]
    temps = pd.merge(temps, countries, on = ["FIPS 10-4"])
    temps["Variation (°C)"] = temps[year_end] - temps[year_start]
    temps = temps[["Name", "Variation (°C)"]].groupby("Name").mean().reset_index()
    temps["Variation (°C)"] = temps["Variation (°C)"].round(decimals = 2)
    
    
    fig = px.choropleth(temps, 
                    geojson=countries_gj,
                    locations = "Name",
                    locationmode = "country names",
                    color = "Variation (°C)", 
                    height = 300,
                    title = f"Average temperature change by country from {year_start} to {year_end}.",
                    **kwargs)
    
    fig.update_layout(margin={"r":0, "t": 30,"l":0,"b":0})
    
    return fig
    
temperature_variation_map(2000, 2020)
```


### How has global temperature chaged year over year compared to the mid 1900s? 



```python
import plotly.graph_objects as go
```


```python
def temperature_variation_plot(year_start, year_end):
    
    conn = sqlite3.connect("temps.db")
    
    cmd0 = \
    f"""
    SELECT * FROM temperatures
    WHERE {year_start} <= Year AND Year <= {year_end}
    """
    cmd1 = \
    f"""
    SELECT * FROM countries
    """
    temps = pd.read_sql_query(cmd0, conn)
    countries = pd.read_sql_query(cmd1,conn)
    conn.close()
    
    temps = temps[["ID", "Year", "Temp"]].groupby(["ID", "Year"]).mean("temp").reset_index()
    temps["FIPS 10-4"] = temps["ID"].str[0:2]
    temps = pd.merge(temps, countries, on = ["FIPS 10-4"])
    temps = temps[["Name", "Year", "Temp"]].groupby("Year").mean().reset_index()
    temps["Temp"] = temps["Temp"].round(3)
    
    
    base_temp = temps[temps["Year"] == 1961].iloc[0]["Temp"]
    base_year = int(temps[temps["Year"] ==int(temps["Year"].median())].iloc[0]["Year"])
    
    temps["Difference"] = temps["Temp"] - base_temp
    temps = temps[["Year", "Difference"]]
    
    
    temps_positive = temps[temps["Difference"] >= 0]
    temps_negative = temps[temps["Difference"] < 0]
    
    fig = go.Figure()
    
    # Positive Figures
    fig.add_trace(go.Bar(x=temps_positive["Year"], y=temps_positive["Difference"],
                base=0,
                marker_color='firebrick',
                name = f"Warmer years than {base_year}"))
    # Negative Figures
    fig.add_trace(go.Bar(x=temps_negative["Year"], y=temps_negative["Difference"],
                base=0,
                marker_color='lightblue',
                name = f"Colder years than {base_year}"))
    
    fig.update_layout(title = f"Global average temperatures compared to {base_year}")
 
    
    return fig.show()
    
temperature_variation_plot(1880, 2020)
```


<div>                            <div id="4babea03-0882-4e12-96b2-e8746e91f759" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("4babea03-0882-4e12-96b2-e8746e91f759")) {                    Plotly.newPlot(                        "4babea03-0882-4e12-96b2-e8746e91f759",                        [{"base": 0, "marker": {"color": "firebrick"}, "name": "Warmer years than 1960", "type": "bar", "x": [1906, 1908, 1910, 1911, 1921, 1931, 1933, 1934, 1938, 1952, 1953, 1954, 1957, 1961, 1998, 2006, 2007, 2012, 2015, 2016, 2017, 2020], "y": [0.08399999999999963, 0.18399999999999928, 0.0860000000000003, 0.15399999999999991, 0.43799999999999883, 0.5429999999999993, 0.1509999999999998, 0.48799999999999955, 0.09499999999999886, 0.10599999999999987, 0.48099999999999987, 0.26900000000000013, 0.030999999999998806, 0.0, 0.15199999999999925, 0.0909999999999993, 0.06599999999999895, 0.4320000000000004, 0.2579999999999991, 0.4209999999999994, 0.3049999999999997, 0.5429999999999993]}, {"base": 0, "marker": {"color": "lightblue"}, "name": "Colder years than 1960", "type": "bar", "x": [1901, 1902, 1903, 1904, 1905, 1907, 1909, 1912, 1913, 1914, 1915, 1916, 1917, 1918, 1919, 1920, 1922, 1923, 1924, 1925, 1926, 1927, 1928, 1929, 1930, 1932, 1935, 1936, 1937, 1939, 1940, 1941, 1942, 1943, 1944, 1945, 1946, 1947, 1948, 1949, 1950, 1951, 1955, 1956, 1958, 1959, 1960, 1962, 1963, 1964, 1965, 1966, 1967, 1968, 1969, 1970, 1971, 1972, 1973, 1974, 1975, 1976, 1977, 1978, 1979, 1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2008, 2009, 2010, 2011, 2013, 2014, 2018, 2019], "y": [-0.3440000000000012, -0.3410000000000011, -0.484, -0.5999999999999996, -0.3960000000000008, -0.23900000000000077, -0.32399999999999984, -0.6340000000000003, -0.030000000000001137, -0.07000000000000028, -0.2569999999999997, -0.7200000000000006, -1.3290000000000006, -0.49600000000000044, -0.5240000000000009, -0.7010000000000005, -0.30799999999999983, -0.3810000000000002, -0.8250000000000011, -0.14499999999999957, -0.277000000000001, -0.2469999999999999, -0.20599999999999952, -0.7640000000000011, -0.09999999999999964, -0.13100000000000023, -0.2789999999999999, -0.4800000000000004, -0.511000000000001, -0.09999999999999964, -0.6790000000000003, -0.38700000000000045, -0.6159999999999997, -0.4920000000000009, -0.4510000000000005, -0.5910000000000011, -0.08300000000000018, -0.46300000000000097, -0.5419999999999998, -0.27800000000000047, -0.641, -0.36599999999999966, -0.1739999999999995, -0.23300000000000054, -0.13100000000000023, -0.20300000000000118, -0.532, -0.31900000000000084, -0.3440000000000012, -0.43599999999999994, -0.45899999999999963, -0.4610000000000003, -0.3019999999999996, -0.5199999999999996, -0.8239999999999998, -0.7599999999999998, -0.7880000000000003, -0.6739999999999995, -0.2710000000000008, -0.5140000000000011, -0.4540000000000006, -0.8670000000000009, -0.3890000000000011, -0.8330000000000002, -0.7409999999999997, -0.5700000000000003, -0.24399999999999977, -0.6509999999999998, -0.37400000000000055, -0.6550000000000011, -1.1219999999999999, -0.5530000000000008, -0.40300000000000047, -0.42300000000000004, -0.6959999999999997, -0.19899999999999984, -0.657, -0.7300000000000004, -1.1150000000000002, -0.5649999999999995, -0.6760000000000002, -1.0969999999999995, -0.6050000000000004, -0.11299999999999955, -0.34999999999999964, -0.15399999999999991, -0.19200000000000017, -0.19899999999999984, -0.34299999999999997, -0.1639999999999997, -0.4169999999999998, -0.41600000000000037, -0.20400000000000063, -0.11599999999999966, -0.32699999999999996, -0.6710000000000012, -0.13700000000000045, -0.29800000000000004]}],                        {"template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "autotypenumbers": "strict", "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}, "title": {"text": "Global average temperatures compared to 1960"}},                        {"responsive": true}                    ).then(function(){

var gd = document.getElementById('4babea03-0882-4e12-96b2-e8746e91f759');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>

